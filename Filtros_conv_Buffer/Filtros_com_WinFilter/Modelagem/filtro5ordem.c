/**************************************************************
WinFilter version 0.8
http://www.winfilter.20m.com
akundert@hotmail.com

Filter type: Low Pass
Filter model: Butterworth
Filter order: 5
Sampling Frequency: 10 Hz
Cut Frequency: 4.000000 Hz
Coefficents Quantization: float

Z domain Zeros
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000

Z domain Poles
z = -0.684659 + j -0.473087
z = -0.684659 + j 0.473087
z = -0.548290 + j -0.234148
z = -0.548290 + j 0.234148
z = -0.509525 + j -0.000000
***************************************************************/
#define Ntap 30

float fir(float NewSample) {
    float FIRCoef[Ntap] = { 
        -0.00593927363071590580,
        0.00670063941568210200,
        -0.00468769849242869990,
        -0.00073033245148772230,
        0.00898808041119883790,
        -0.01793571976116651800,
        0.02391585809562953000,
        -0.02247104870335529500,
        0.00964701108695892320,
        0.01641172657168906200,
        -0.05411834888362768200,
        0.09798417436795631200,
        -0.13949642707952015000,
        0.16931855393459608000,
        0.82119363730922967000,
        0.16931855393459608000,
        -0.13949642707952015000,
        0.09798417436795631200,
        -0.05411834888362768200,
        0.01641172657168906200,
        0.00964701108695892320,
        -0.02247104870335529500,
        0.02391585809562953000,
        -0.01793571976116651800,
        0.00898808041119883790,
        -0.00073033245148772230,
        -0.00468769849242869990,
        0.00670063941568210200,
        -0.00593927363071590580,
        0.00363197292795276870
    };

    static float x[Ntap]; //input samples
    float y=0;            //output sample
    int n;

    //shift the old samples
    for(n=Ntap-1; n>0; n--)
       x[n] = x[n-1];

    //Calculate the new output
    x[0] = NewSample;
    for(n=0; n<Ntap; n++)
        y += FIRCoef[n] * x[n];
    
    return y;
}
